function doPost(e) {
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var data = JSON.parse(e.postData.contents);

  sheet.appendRow([
    new Date(),
    data.userAgent || "brak",
    data.page || "brak",
    data.referrer || "brak",
    data.screen || "brak",
    data.language || "brak",
    data.timezone || "brak",
    data.time || "brak"
  ]);

  return ContentService.createTextOutput("OK").setMimeType(ContentService.MimeType.TEXT);
}


page:

<script>
  fetch("https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      userAgent: navigator.userAgent,
      page: location.href,
      referrer: document.referrer,
      screen: `${screen.width}x${screen.height}`,
      language: navigator.language,
      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
      time: new Date().toISOString()
    })
  }).catch(console.error);
</script>
